{"version":3,"sources":["webpack:///./src/views/articles/Create.vue?d3b9","webpack:///./src/views/articles/Create.vue?cb30","webpack:///src/views/articles/Create.vue","webpack:///./src/views/articles/Create.vue?ae14","webpack:///./src/views/articles/Create.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","attrs","directives","name","rawName","value","expression","modifiers","title","arg","domProps","on","$event","target","composing","trim","saveTitle","$forceUpdate","_m","model","callback","$$v","_l","item","key","label","post","staticRenderFns","component"],"mappings":"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","file":"js/chunk-84f8cf22.93461016.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Create.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Create.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"blog-container\"},[_c('div',{staticClass:\"blog-pages\"},[_c('div',{staticClass:\"col-md-12 panel\"},[_c('div',{staticClass:\"panel-body\"},[_c('h2',{staticClass:\"text-center\"},[_vm._v(\"创作文章\")]),_c('hr'),_c('div',{attrs:{\"data-validator-form\":\"\"}},[_c('div',{staticClass:\"form-group\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model.trim\",value:(_vm.title),expression:\"title\",modifiers:{\"trim\":true}},{name:\"validator\",rawName:\"v-validator:blur.required\",value:({ title: '标题' }),expression:\"{ title: '标题' }\",arg:\"blur\",modifiers:{\"required\":true}}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"placeholder\":\"请填写标题\"},domProps:{\"value\":(_vm.title)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.title=$event.target.value.trim()},_vm.saveTitle],\"blur\":function($event){return _vm.$forceUpdate()}}})]),_vm._m(0),_c('br'),_c('el-select',{staticClass:\"select-type\",attrs:{\"placeholder\":\"请选择文章分类\"},model:{value:(_vm.value),callback:function ($$v) {_vm.value=$$v},expression:\"value\"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1),_c('div',{staticClass:\"form-group\"},[_c('button',{staticClass:\"btn btn-primary\",attrs:{\"type\":\"submit\"},on:{\"click\":_vm.post}},[_vm._v(\"发 布\")])])],1)])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"form-group\"},[_c('textarea',{attrs:{\"id\":\"editor\"}})])}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"blog-container\">\n    <div class=\"blog-pages\">\n      <div class=\"col-md-12 panel\">\n        <div class=\"panel-body\">\n          <h2 class=\"text-center\">创作文章</h2>\n          <hr>\n          <div data-validator-form>\n            <div class=\"form-group\">\n              <input v-model.trim=\"title\" v-validator:blur.required=\"{ title: '标题' }\" type=\"text\" class=\"form-control\"\n                placeholder=\"请填写标题\" @input=\"saveTitle\">\n            </div>\n            <div class=\"form-group\">\n              <textarea id=\"editor\"></textarea>\n            </div>\n            <br>\n\n            <el-select v-model=\"value\" placeholder=\"请选择文章分类\" class=\"select-type\">\n              <el-option v-for=\"item in options\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\n              </el-option>\n            </el-select>\n            <div class=\"form-group\">\n              <button class=\"btn btn-primary\" type=\"submit\" @click=\"post\">发 布</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\n  import SimpleMDE from 'simplemde'\n  import hljs from 'highlight.js'\n  import ls from '@/utils/localStorage'\n  import { postArticle, findArticle, editArticle, getPostArticle } from 'network/article'\n  window.hljs = hljs\n\n  export default {\n    name: 'Create',\n    data() {\n      return {\n        title: '', // 文章标题\n        content: '', // 文章内容\n        aid: undefined,\n        options: [{\n          value: '程序人生',\n          label: '程序人生'\n        }, {\n          value: '服务器端',\n          label: '服务器端'\n        }, {\n          value: 'HTML/CSS',\n          label: 'HTML/CSS'\n        }],\n        value: ''\n      }\n    },\n    beforeRouteEnter(to, from, next) {\n      console.log(to)\n      next()\n    },\n    created() {\n      if (this.$route.params.articleId) {\n        this.aid = this.$route.params.articleId\n      }\n    },\n    mounted() {\n      const simplemde = new SimpleMDE({\n        element: document.querySelector('#editor'),\n        placeholder: '请使用 Markdown 格式书写 ;-)，代码片段黏贴时请注意使用高亮语法。',\n        spellChecker: false,\n        autoDownloadFontAwesome: false,\n        autosave: {\n          enabled: true,\n          uniqueId: 'vuejs-essential'\n        },\n        renderingConfig: {\n          codeSyntaxHighlighting: true\n        }\n      })\n\n      simplemde.codemirror.on('change', () => {\n        this.content = simplemde.value()\n      })\n\n      this.simplemde = simplemde\n      this.fillContent(this.aid)\n    },\n    methods: {\n      saveTitle() {\n        ls.setItem('smde_title', this.title)\n      },\n      fillContent(articleId) {\n        const simplemde = this.simplemde\n        const title = ls.getItem('smde_title')\n        if (articleId) {\n          // findArticle(articleId).then(res => {\n          //   this.title = res.data.title\n          //   this.content = res.data.content\n          // })\n          this.title = ls.getItem('article').title\n          this.content = ls.getItem('article').content\n          this.value = ls.getItem('article').atype\n          simplemde.value(this.content)\n\n        } else {\n          if (title !== null) {\n            this.title = title\n          }\n\n          this.content = simplemde.value()\n        }\n\n\n      },\n      post() {\n        const title = this.title\n        const content = this.content\n        const uid = this.$store.state.user.id\n        const type = this.value\n        if (type == \"\") {\n          this.$message.error('请选择文章分类');\n        } else {\n          if (this.aid == undefined) {\n            if (title !== '' && content.trim() !== '') {\n              postArticle(title, content, type, uid).then(res => {\n                this.$message({\n                  message: '发表成功',\n                  type: 'success'\n                });\n                getPostArticle(uid).then(res => {\n                  this.clearData()\n                  this.$router.push({ name: 'Content', params: { user: this.$store.state.user.username, articleId: res.data.id } })\n                  // this.$router.push({ name: 'Content', params:  { user: this.$store.state.user.username, articleId: this.aid } })\n                }).catch(err => {\n                  console.log(err)\n                })\n\n\n              }).catch(err => {\n                this.$message.error('发表失败');\n              })\n\n            }\n          } else {\n            editArticle(this.title, this.content, this.value, this.aid).then(res => {\n              this.$message({\n                message: '编辑成功',\n                type: 'success'\n              });\n              this.clearData()\n              this.$router.push({ name: 'Content', params: { user: this.$store.state.user.username, articleId: this.aid } })\n            }).catch(err => {\n              this.$message.error('编辑失败');\n            })\n          }\n        }\n\n\n      },\n      clearData() {\n        this.title = ''\n        ls.removeItem('smde_title')\n        this.simplemde.value('')\n        this.simplemde.clearAutosavedValue()\n      },\n      setArticleId(articleId) {\n        this.aid = articleId\n        this.fillContent(articleId)\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n  .blog-container {\n    max-width: 980px;\n    margin: 0 auto;\n    margin-top: 20px;\n  }\n\n  textarea {\n    height: 200px;\n  }\n\n  .btn-primary {\n    color: #fff;\n    background-color: #6ca6cd;\n    border-color: #6ca6cd;\n  }\n\n  .select-type {\n    margin-bottom: 20px\n  }\n\n  @import '~simplemde/dist/simplemde.min.css';\n  @import '~highlight.js/styles/paraiso-dark.css';\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Create.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Create.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Create.vue?vue&type=template&id=7a11738b&\"\nimport script from \"./Create.vue?vue&type=script&lang=js&\"\nexport * from \"./Create.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Create.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}